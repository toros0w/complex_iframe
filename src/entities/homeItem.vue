<template>
  <div class="homeItem">
    <div class="homeItem__image">
      <img v-if="houseImage" :src="houseImage" alt="" />
    </div>
    <div class="homeItem__content">
      <button class="homeItem__btnMenu">
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M6.375 7.5C6.07833 7.5 5.78832 7.58797 5.54165 7.7528C5.29497 7.91762 5.10271 8.15189 4.98918 8.42598C4.87565 8.70007 4.84594 9.00166 4.90382 9.29264C4.9617 9.58361 5.10456 9.85088 5.31434 10.0607C5.52412 10.2704 5.79139 10.4133 6.08237 10.4712C6.37334 10.5291 6.67494 10.4994 6.94903 10.3858C7.22312 10.2723 7.45738 10.08 7.62221 9.83336C7.78703 9.58668 7.875 9.29667 7.875 9C7.875 8.60218 7.71697 8.22065 7.43566 7.93934C7.15436 7.65804 6.77283 7.5 6.375 7.5ZM6.375 12.75C6.07833 12.75 5.78832 12.838 5.54165 13.0028C5.29497 13.1676 5.10271 13.4019 4.98918 13.676C4.87565 13.9501 4.84594 14.2517 4.90382 14.5426C4.9617 14.8336 5.10456 15.1009 5.31434 15.3107C5.52412 15.5204 5.79139 15.6633 6.08237 15.7212C6.37334 15.7791 6.67494 15.7494 6.94903 15.6358C7.22312 15.5223 7.45738 15.33 7.62221 15.0834C7.78703 14.8367 7.875 14.5467 7.875 14.25C7.875 13.8522 7.71697 13.4706 7.43566 13.1893C7.15436 12.908 6.77283 12.75 6.375 12.75ZM11.625 5.25C11.9217 5.25 12.2117 5.16203 12.4584 4.99721C12.705 4.83238 12.8973 4.59812 13.0108 4.32403C13.1244 4.04994 13.1541 3.74834 13.0962 3.45737C13.0383 3.16639 12.8954 2.89912 12.6857 2.68934C12.4759 2.47956 12.2086 2.3367 11.9176 2.27882C11.6267 2.22094 11.3251 2.25065 11.051 2.36418C10.7769 2.47771 10.5426 2.66997 10.3778 2.91665C10.213 3.16332 10.125 3.45333 10.125 3.75C10.125 4.14783 10.283 4.52936 10.5643 4.81066C10.8456 5.09197 11.2272 5.25 11.625 5.25ZM6.375 2.25C6.07833 2.25 5.78832 2.33797 5.54165 2.5028C5.29497 2.66762 5.10271 2.90189 4.98918 3.17598C4.87565 3.45006 4.84594 3.75166 4.90382 4.04264C4.9617 4.33361 5.10456 4.60088 5.31434 4.81066C5.52412 5.02044 5.79139 5.1633 6.08237 5.22118C6.37334 5.27906 6.67494 5.24935 6.94903 5.13582C7.22312 5.02229 7.45738 4.83003 7.62221 4.58336C7.78703 4.33668 7.875 4.04667 7.875 3.75C7.875 3.35218 7.71697 2.97064 7.43566 2.68934C7.15436 2.40804 6.77283 2.25 6.375 2.25ZM11.625 12.75C11.3283 12.75 11.0383 12.838 10.7916 13.0028C10.545 13.1676 10.3527 13.4019 10.2392 13.676C10.1257 13.9501 10.0959 14.2517 10.1538 14.5426C10.2117 14.8336 10.3546 15.1009 10.5643 15.3107C10.7741 15.5204 11.0414 15.6633 11.3324 15.7212C11.6233 15.7791 11.9249 15.7494 12.199 15.6358C12.4731 15.5223 12.7074 15.33 12.8722 15.0834C13.037 14.8367 13.125 14.5467 13.125 14.25C13.125 13.8522 12.967 13.4706 12.6857 13.1893C12.4044 12.908 12.0228 12.75 11.625 12.75ZM11.625 7.5C11.3283 7.5 11.0383 7.58797 10.7916 7.7528C10.545 7.91762 10.3527 8.15189 10.2392 8.42598C10.1257 8.70007 10.0959 9.00166 10.1538 9.29264C10.2117 9.58361 10.3546 9.85088 10.5643 10.0607C10.7741 10.2704 11.0414 10.4133 11.3324 10.4712C11.6233 10.5291 11.9249 10.4994 12.199 10.3858C12.4731 10.2723 12.7074 10.08 12.8722 9.83336C13.037 9.58668 13.125 9.29667 13.125 9C13.125 8.60218 12.967 8.22065 12.6857 7.93934C12.4044 7.65804 12.0228 7.5 11.625 7.5Z"
            fill="#2A2A2A"
          />
        </svg>
      </button>
      <div class="homeItem__desc">{{ house.name }}</div>
      <div class="homeItem__title">{{ house.name_complex }}</div>
      <div class="homeItem__roms">Помещений: <strong>{{ house.total_rooms }}</strong></div>
    </div>
    <div class="homeItem__nav">
      <Button
        v-if="!isArchivePage"
        v-tooltip="'Редактировать дом'"
        severity="secondary"
        class="homeItem__edit"
        @click="router.push('/my-objects/' + $route.params.id + '/home/'+house.id)"
      >
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M15.75 9.00002C15.5511 9.00002 15.3603 9.07903 15.2197 9.21969C15.079 9.36034 15 9.5511 15 9.75002V14.25C15 14.4489 14.921 14.6397 14.7803 14.7803C14.6397 14.921 14.4489 15 14.25 15H3.75C3.55109 15 3.36032 14.921 3.21967 14.7803C3.07902 14.6397 3 14.4489 3 14.25V3.75002C3 3.5511 3.07902 3.36034 3.21967 3.21969C3.36032 3.07903 3.55109 3.00002 3.75 3.00002H8.25C8.44891 3.00002 8.63968 2.921 8.78033 2.78035C8.92098 2.63969 9 2.44893 9 2.25002C9 2.0511 8.92098 1.86034 8.78033 1.71969C8.63968 1.57903 8.44891 1.50002 8.25 1.50002H3.75C3.15326 1.50002 2.58097 1.73707 2.15901 2.15903C1.73705 2.58098 1.5 3.15328 1.5 3.75002V14.25C1.5 14.8468 1.73705 15.419 2.15901 15.841C2.58097 16.263 3.15326 16.5 3.75 16.5H14.25C14.8467 16.5 15.419 16.263 15.841 15.841C16.2629 15.419 16.5 14.8468 16.5 14.25V9.75002C16.5 9.5511 16.421 9.36034 16.2803 9.21969C16.1397 9.07903 15.9489 9.00002 15.75 9.00002ZM4.5 9.57001V12.75C4.5 12.9489 4.57902 13.1397 4.71967 13.2803C4.86032 13.421 5.05109 13.5 5.25 13.5H8.43C8.5287 13.5006 8.62655 13.4817 8.71793 13.4443C8.80931 13.407 8.89242 13.352 8.9625 13.2825L14.1525 8.08502L16.2825 6.00002C16.3528 5.93029 16.4086 5.84734 16.4467 5.75595C16.4847 5.66455 16.5043 5.56652 16.5043 5.46752C16.5043 5.36851 16.4847 5.27048 16.4467 5.17908C16.4086 5.08769 16.3528 5.00474 16.2825 4.93502L13.1025 1.71752C13.0328 1.64722 12.9498 1.59142 12.8584 1.55335C12.767 1.51527 12.669 1.49567 12.57 1.49567C12.471 1.49567 12.373 1.51527 12.2816 1.55335C12.1902 1.59142 12.1072 1.64722 12.0375 1.71752L9.9225 3.84002L4.7175 9.03752C4.64799 9.1076 4.59299 9.19071 4.55567 9.28209C4.51835 9.37346 4.49943 9.47131 4.5 9.57001ZM12.57 3.30752L14.6925 5.43002L13.6275 6.49502L11.505 4.37252L12.57 3.30752ZM6 9.87752L10.4475 5.43002L12.57 7.55252L8.1225 12H6V9.87752Z"
            fill="#666666"
          />
        </svg>
      </Button>
      <Button
        v-else
        severity="secondary"
        class="homeItem__edit"
        v-tooltip="'Вернуть из архива'"
        @click="$emit('unArchiveItem')"
      >
        <Unarchive />
      </Button>
      <!-- <Button severity="secondary" class="homeItem__copy">
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M12 15H6C5.40326 15 4.83097 14.7629 4.40901 14.341C3.98705 13.919 3.75 13.3467 3.75 12.75V5.25C3.75 5.05109 3.67098 4.86032 3.53033 4.71967C3.38968 4.57902 3.19891 4.5 3 4.5C2.80109 4.5 2.61032 4.57902 2.46967 4.71967C2.32902 4.86032 2.25 5.05109 2.25 5.25V12.75C2.25 13.7446 2.64509 14.6984 3.34835 15.4017C4.05161 16.1049 5.00544 16.5 6 16.5H12C12.1989 16.5 12.3897 16.421 12.5303 16.2803C12.671 16.1397 12.75 15.9489 12.75 15.75C12.75 15.5511 12.671 15.3603 12.5303 15.2197C12.3897 15.079 12.1989 15 12 15ZM15.75 6.705C15.7422 6.6361 15.7271 6.56822 15.705 6.5025V6.435C15.6689 6.35788 15.6208 6.287 15.5625 6.225L11.0625 1.725C11.0005 1.66666 10.9296 1.61856 10.8525 1.5825H10.785L10.545 1.5H7.5C6.90326 1.5 6.33097 1.73705 5.90901 2.15901C5.48705 2.58097 5.25 3.15326 5.25 3.75V11.25C5.25 11.8467 5.48705 12.419 5.90901 12.841C6.33097 13.2629 6.90326 13.5 7.5 13.5H13.5C14.0967 13.5 14.669 13.2629 15.091 12.841C15.5129 12.419 15.75 11.8467 15.75 11.25V6.75C15.75 6.75 15.75 6.75 15.75 6.705ZM11.25 4.0575L13.1925 6H12C11.8011 6 11.6103 5.92098 11.4697 5.78033C11.329 5.63968 11.25 5.44891 11.25 5.25V4.0575ZM14.25 11.25C14.25 11.4489 14.171 11.6397 14.0303 11.7803C13.8897 11.921 13.6989 12 13.5 12H7.5C7.30109 12 7.11032 11.921 6.96967 11.7803C6.82902 11.6397 6.75 11.4489 6.75 11.25V3.75C6.75 3.55109 6.82902 3.36032 6.96967 3.21967C7.11032 3.07902 7.30109 3 7.5 3H9.75V5.25C9.75 5.84674 9.98705 6.41903 10.409 6.84099C10.831 7.26295 11.4033 7.5 12 7.5H14.25V11.25Z"
            fill="#666666"
          />
        </svg>
      </Button> -->
      <Button
        v-if="isArchivePage"
        severity="secondary"
        class="homeItem__delete"
        v-tooltip="'Удалить дом'"
        @click.prevent="showDeleteTemplate($event)"
      >
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M7.5 13.5C7.69891 13.5 7.88968 13.421 8.03033 13.2803C8.17098 13.1397 8.25 12.9489 8.25 12.75V8.25C8.25 8.05109 8.17098 7.86032 8.03033 7.71967C7.88968 7.57902 7.69891 7.5 7.5 7.5C7.30109 7.5 7.11032 7.57902 6.96967 7.71967C6.82902 7.86032 6.75 8.05109 6.75 8.25V12.75C6.75 12.9489 6.82902 13.1397 6.96967 13.2803C7.11032 13.421 7.30109 13.5 7.5 13.5ZM15 4.5H12V3.75C12 3.15326 11.7629 2.58097 11.341 2.15901C10.919 1.73705 10.3467 1.5 9.75 1.5H8.25C7.65326 1.5 7.08097 1.73705 6.65901 2.15901C6.23705 2.58097 6 3.15326 6 3.75V4.5H3C2.80109 4.5 2.61032 4.57902 2.46967 4.71967C2.32902 4.86032 2.25 5.05109 2.25 5.25C2.25 5.44891 2.32902 5.63968 2.46967 5.78033C2.61032 5.92098 2.80109 6 3 6H3.75V14.25C3.75 14.8467 3.98705 15.419 4.40901 15.841C4.83097 16.2629 5.40326 16.5 6 16.5H12C12.5967 16.5 13.169 16.2629 13.591 15.841C14.0129 15.419 14.25 14.8467 14.25 14.25V6H15C15.1989 6 15.3897 5.92098 15.5303 5.78033C15.671 5.63968 15.75 5.44891 15.75 5.25C15.75 5.05109 15.671 4.86032 15.5303 4.71967C15.3897 4.57902 15.1989 4.5 15 4.5ZM7.5 3.75C7.5 3.55109 7.57902 3.36032 7.71967 3.21967C7.86032 3.07902 8.05109 3 8.25 3H9.75C9.94891 3 10.1397 3.07902 10.2803 3.21967C10.421 3.36032 10.5 3.55109 10.5 3.75V4.5H7.5V3.75ZM12.75 14.25C12.75 14.4489 12.671 14.6397 12.5303 14.7803C12.3897 14.921 12.1989 15 12 15H6C5.80109 15 5.61032 14.921 5.46967 14.7803C5.32902 14.6397 5.25 14.4489 5.25 14.25V6H12.75V14.25ZM10.5 13.5C10.6989 13.5 10.8897 13.421 11.0303 13.2803C11.171 13.1397 11.25 12.9489 11.25 12.75V8.25C11.25 8.05109 11.171 7.86032 11.0303 7.71967C10.8897 7.57902 10.6989 7.5 10.5 7.5C10.3011 7.5 10.1103 7.57902 9.96967 7.71967C9.82902 7.86032 9.75 8.05109 9.75 8.25V12.75C9.75 12.9489 9.82902 13.1397 9.96967 13.2803C10.1103 13.421 10.3011 13.5 10.5 13.5Z"
            fill="#666666"
          />
        </svg>
      </Button>
      <Button
        v-else
        v-tooltip="'Перенести в архив'"
        severity="secondary"
        class="homeItem__archive"
        @click="showUrchiveTemplate"
      >
        <ArchveIcon />
      </Button>
    </div>
    <ConfirmPopup group="deleteHouse" :pt="confirmpopupStyle"></ConfirmPopup>
  </div>
</template>

<script setup>
import { computed, ref } from "vue";
import { useRouter } from "vue-router";
import ArchveIcon from '@/shared/assets/icons/archive.vue'
import Unarchive from "@/shared/assets/icons/unarchive.vue";
import ConfirmPopup from "primevue/confirmpopup";
import { useConfirm } from "primevue/useconfirm";
import { confirmpopupStyle } from "@/shared/utils/util";
const props = defineProps({
  house: Object,
  isArchivePage: Boolean
});
const router = useRouter();
const confirm = useConfirm();
const emits = defineEmits(
  ["deleteItem", "archiveItem"]
);
const houseImage = computed(() => {
  return props.house?.images.length ? props.house?.images[0].url : null;
})

const showDeleteTemplate = (event, index) => {
  confirm.require({
    target: event.currentTarget,
    group: "deleteHouse",
    message: "Удалить Дом?",
    acceptLabel: "Да",
    rejectLabel: "Нет",
    acceptClass: "!bg-green !shadow-none",
    rejectClass: "!bg-red !shadow-none",
    accept: () => {
      emits('deleteItem')
    },
    reject: () => {
      return;
    },
  });
};

const showUrchiveTemplate = (event, index) => {
  confirm.require({
    target: event.currentTarget,
    group: "deleteHouse",
    message: "Перенести в архив Дом?",
    acceptLabel: "Да",
    rejectLabel: "Нет",
    acceptClass: "!bg-green !shadow-none",
    rejectClass: "!bg-red !shadow-none",
    accept: () => {
      emits('archiveItem')
    },
    reject: () => {
      return;
    },
  });
};


</script>

<style>
  .p-confirm-popup-footer {
    text-align: center !important;
  }
</style>

<style scoped lang="scss">
.homeItem {
  position: relative;
  width: 100%;
  height: 224px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.05);
  @apply bg-white;
  border-radius: 4px;
  &__image {
    width: 100%;
    height: calc(100% - 64px);
    flex-grow: 1;
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }
  &__content {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    width: 100%;
    height: calc(100% - 64px);
    z-index: 3;
    background-color: rgba($color: #ffffff, $alpha: 0.85);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    row-gap: 10px;
  }

  &__btnMenu {
    position: absolute;
    top: 20px;
    right: 20px;
  }

  &__desc,
  &__rooms {
    font-size: 16px;
  }

  &__title {
    font-weight: 600;
    font-style: 18px;
  }

  &__nav {
    position: relative;
    @apply bg-white;
    width: 100%;
    height: 64px;
    display: flex;
    justify-content: center;
    align-items: center;
    column-gap: 8px;

    button {
      display: flex;
      justify-content: center;
      align-items: center;
      border: 1px solid #dedede;
      padding: 8px;
      border-radius: 3px;
    }
  }
}
</style>
