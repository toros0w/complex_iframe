<template>
  <div
    class="tabItem flex flex-row items-center gap-x-2 w-max pb-4"
    :class="[active ? 'border-b-2 border-green -mb-1' : '']"
    @click="() => emits('tab:click')"
    :draggable="!isEditTitle"
  >
    <div class="tabItem__dragIcon">
      <svg
        width="8"
        height="12"
        viewBox="0 0 8 12"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M1.95866 4.83333C1.72791 4.83333 1.50235 4.90176 1.31049 5.02995C1.11864 5.15815 0.969102 5.34036 0.8808 5.55354C0.792498 5.76672 0.769394 6.0013 0.81441 6.22761C0.859426 6.45392 0.97054 6.6618 1.1337 6.82496C1.29686 6.98812 1.50474 7.09923 1.73105 7.14425C1.95737 7.18927 2.19194 7.16616 2.40512 7.07786C2.6183 6.98956 2.80051 6.84002 2.92871 6.64817C3.0569 6.45631 3.12533 6.23075 3.12533 6C3.12533 5.69058 3.00241 5.39384 2.78362 5.17504C2.56482 4.95625 2.26808 4.83333 1.95866 4.83333ZM1.95866 8.91667C1.72791 8.91667 1.50235 8.98509 1.31049 9.11329C1.11864 9.24148 0.969102 9.42369 0.8808 9.63687C0.792498 9.85005 0.769394 10.0846 0.81441 10.3109C0.859426 10.5373 0.97054 10.7451 1.1337 10.9083C1.29686 11.0715 1.50474 11.1826 1.73105 11.2276C1.95737 11.2726 2.19194 11.2495 2.40512 11.1612C2.6183 11.0729 2.80051 10.9234 2.92871 10.7315C3.0569 10.5396 3.12533 10.3141 3.12533 10.0833C3.12533 9.77391 3.00241 9.47717 2.78362 9.25838C2.56482 9.03958 2.26808 8.91667 1.95866 8.91667ZM6.04199 3.08333C6.27274 3.08333 6.4983 3.01491 6.69016 2.88672C6.88202 2.75852 7.03155 2.57631 7.11985 2.36313C7.20816 2.14995 7.23126 1.91537 7.18624 1.68906C7.14123 1.46275 7.03011 1.25487 6.86695 1.09171C6.70379 0.928548 6.49591 0.817434 6.2696 0.772418C6.04329 0.727402 5.80871 0.750505 5.59553 0.838808C5.38235 0.92711 5.20014 1.07664 5.07195 1.2685C4.94375 1.46036 4.87533 1.68592 4.87533 1.91667C4.87533 2.22609 4.99824 2.52283 5.21704 2.74163C5.43583 2.96042 5.73257 3.08333 6.04199 3.08333ZM1.95866 0.75C1.72791 0.75 1.50235 0.818424 1.31049 0.946619C1.11864 1.07481 0.969102 1.25702 0.8808 1.4702C0.792498 1.68338 0.769394 1.91796 0.81441 2.14427C0.859426 2.37058 0.97054 2.57846 1.1337 2.74163C1.29686 2.90479 1.50474 3.0159 1.73105 3.06092C1.95737 3.10593 2.19194 3.08283 2.40512 2.99453C2.6183 2.90622 2.80051 2.75669 2.92871 2.56483C3.0569 2.37298 3.12533 2.14741 3.12533 1.91667C3.12533 1.60725 3.00241 1.3105 2.78362 1.09171C2.56482 0.872917 2.26808 0.75 1.95866 0.75ZM6.04199 8.91667C5.81125 8.91667 5.58569 8.98509 5.39383 9.11329C5.20197 9.24148 5.05244 9.42369 4.96413 9.63687C4.87583 9.85005 4.85273 10.0846 4.89774 10.3109C4.94276 10.5373 5.05387 10.7451 5.21704 10.9083C5.3802 11.0715 5.58808 11.1826 5.81439 11.2276C6.0407 11.2726 6.27528 11.2495 6.48846 11.1612C6.70164 11.0729 6.88385 10.9234 7.01204 10.7315C7.14024 10.5396 7.20866 10.3141 7.20866 10.0833C7.20866 9.77391 7.08574 9.47717 6.86695 9.25838C6.64816 9.03958 6.35141 8.91667 6.04199 8.91667ZM6.04199 4.83333C5.81125 4.83333 5.58569 4.90176 5.39383 5.02995C5.20197 5.15815 5.05244 5.34036 4.96413 5.55354C4.87583 5.76672 4.85273 6.0013 4.89774 6.22761C4.94276 6.45392 5.05387 6.6618 5.21704 6.82496C5.3802 6.98812 5.58808 7.09923 5.81439 7.14425C6.0407 7.18927 6.27528 7.16616 6.48846 7.07786C6.70164 6.98956 6.88385 6.84002 7.01204 6.64817C7.14024 6.45631 7.20866 6.23075 7.20866 6C7.20866 5.69058 7.08574 5.39384 6.86695 5.17504C6.64816 4.95625 6.35141 4.83333 6.04199 4.83333Z"
          fill="#9E9EA4"
        />
      </svg>
    </div>
    <div class="tabItem__title font-bold text-sm" v-if="!isEditTitle">
      {{ title }}
    </div>
    <InputText :pt="styleInput" v-model="titleInput" v-else />
    <button class="tabItem__edit" @click="isEditTitle = !isEditTitle">
      <svg
        width="18"
        height="18"
        viewBox="0 0 18 18"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        v-if="!isEditTitle"
      >
        <path
          d="M15.75 8.99995C15.5511 8.99995 15.3603 9.07897 15.2197 9.21962C15.079 9.36028 15 9.55104 15 9.74995V14.25C15 14.4489 14.921 14.6396 14.7803 14.7803C14.6397 14.9209 14.4489 15 14.25 15H3.75C3.55109 15 3.36032 14.9209 3.21967 14.7803C3.07902 14.6396 3 14.4489 3 14.25V3.74995C3 3.55104 3.07902 3.36028 3.21967 3.21962C3.36032 3.07897 3.55109 2.99995 3.75 2.99995H8.25C8.44891 2.99995 8.63968 2.92094 8.78033 2.78028C8.92098 2.63963 9 2.44887 9 2.24995C9 2.05104 8.92098 1.86028 8.78033 1.71962C8.63968 1.57897 8.44891 1.49995 8.25 1.49995H3.75C3.15326 1.49995 2.58097 1.73701 2.15901 2.15896C1.73705 2.58092 1.5 3.15322 1.5 3.74995V14.25C1.5 14.8467 1.73705 15.419 2.15901 15.8409C2.58097 16.2629 3.15326 16.5 3.75 16.5H14.25C14.8467 16.5 15.419 16.2629 15.841 15.8409C16.2629 15.419 16.5 14.8467 16.5 14.25V9.74995C16.5 9.55104 16.421 9.36028 16.2803 9.21962C16.1397 9.07897 15.9489 8.99995 15.75 8.99995ZM4.5 9.56995V12.75C4.5 12.9489 4.57902 13.1396 4.71967 13.2803C4.86032 13.4209 5.05109 13.5 5.25 13.5H8.43C8.5287 13.5005 8.62655 13.4816 8.71793 13.4443C8.80931 13.407 8.89242 13.352 8.9625 13.2825L14.1525 8.08495L16.2825 5.99995C16.3528 5.93023 16.4086 5.84728 16.4467 5.75589C16.4847 5.66449 16.5043 5.56646 16.5043 5.46745C16.5043 5.36845 16.4847 5.27042 16.4467 5.17902C16.4086 5.08763 16.3528 5.00468 16.2825 4.93495L13.1025 1.71745C13.0328 1.64716 12.9498 1.59136 12.8584 1.55329C12.767 1.51521 12.669 1.49561 12.57 1.49561C12.471 1.49561 12.373 1.51521 12.2816 1.55329C12.1902 1.59136 12.1072 1.64716 12.0375 1.71745L9.9225 3.83995L4.7175 9.03745C4.64799 9.10753 4.59299 9.19065 4.55567 9.28202C4.51835 9.3734 4.49943 9.47125 4.5 9.56995ZM12.57 3.30745L14.6925 5.42995L13.6275 6.49495L11.505 4.37245L12.57 3.30745ZM6 9.87745L10.4475 5.42995L12.57 7.55245L8.1225 12H6V9.87745Z"
          fill="#9E9EA4"
        />
      </svg>
      <svg
        width="14"
        height="14"
        viewBox="0 0 14 14"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        v-else
      >
        <path
          d="M13.5325 4.9675L9.0325 0.4675C8.96339 0.400037 8.8819 0.346557 8.7925 0.31C8.69951 0.272213 8.60036 0.251874 8.5 0.25H2.5C1.90326 0.25 1.33097 0.487053 0.90901 0.90901C0.487053 1.33097 0.25 1.90326 0.25 2.5V11.5C0.25 12.0967 0.487053 12.669 0.90901 13.091C1.33097 13.5129 1.90326 13.75 2.5 13.75H11.5C12.0967 13.75 12.669 13.5129 13.091 13.091C13.5129 12.669 13.75 12.0967 13.75 11.5V5.5C13.7506 5.4013 13.7317 5.30345 13.6943 5.21207C13.657 5.12069 13.602 5.03758 13.5325 4.9675ZM4.75 1.75H7.75V3.25H4.75V1.75ZM9.25 12.25H4.75V10C4.75 9.80109 4.82902 9.61032 4.96967 9.46967C5.11032 9.32902 5.30109 9.25 5.5 9.25H8.5C8.69891 9.25 8.88968 9.32902 9.03033 9.46967C9.17098 9.61032 9.25 9.80109 9.25 10V12.25ZM12.25 11.5C12.25 11.6989 12.171 11.8897 12.0303 12.0303C11.8897 12.171 11.6989 12.25 11.5 12.25H10.75V10C10.75 9.40326 10.5129 8.83097 10.091 8.40901C9.66903 7.98705 9.09674 7.75 8.5 7.75H5.5C4.90326 7.75 4.33097 7.98705 3.90901 8.40901C3.48705 8.83097 3.25 9.40326 3.25 10V12.25H2.5C2.30109 12.25 2.11032 12.171 1.96967 12.0303C1.82902 11.8897 1.75 11.6989 1.75 11.5V2.5C1.75 2.30109 1.82902 2.11032 1.96967 1.96967C2.11032 1.82902 2.30109 1.75 2.5 1.75H3.25V4C3.25 4.19891 3.32902 4.38968 3.46967 4.53033C3.61032 4.67098 3.80109 4.75 4 4.75H8.5C8.69891 4.75 8.88968 4.67098 9.03033 4.53033C9.17098 4.38968 9.25 4.19891 9.25 4V2.8075L12.25 5.8075V11.5Z"
          fill="#9E9EA4"
        />
      </svg>
    </button>
    <button class="tabItem__delete" @click.stop="emits('delete:entrance', $event)" >
      <svg
        width="18"
        height="18"
        viewBox="0 0 18 18"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M7.5 13.5C7.69891 13.5 7.88968 13.421 8.03033 13.2803C8.17098 13.1397 8.25 12.9489 8.25 12.75V8.25C8.25 8.05109 8.17098 7.86032 8.03033 7.71967C7.88968 7.57902 7.69891 7.5 7.5 7.5C7.30109 7.5 7.11032 7.57902 6.96967 7.71967C6.82902 7.86032 6.75 8.05109 6.75 8.25V12.75C6.75 12.9489 6.82902 13.1397 6.96967 13.2803C7.11032 13.421 7.30109 13.5 7.5 13.5ZM15 4.5H12V3.75C12 3.15326 11.7629 2.58097 11.341 2.15901C10.919 1.73705 10.3467 1.5 9.75 1.5H8.25C7.65326 1.5 7.08097 1.73705 6.65901 2.15901C6.23705 2.58097 6 3.15326 6 3.75V4.5H3C2.80109 4.5 2.61032 4.57902 2.46967 4.71967C2.32902 4.86032 2.25 5.05109 2.25 5.25C2.25 5.44891 2.32902 5.63968 2.46967 5.78033C2.61032 5.92098 2.80109 6 3 6H3.75V14.25C3.75 14.8467 3.98705 15.419 4.40901 15.841C4.83097 16.2629 5.40326 16.5 6 16.5H12C12.5967 16.5 13.169 16.2629 13.591 15.841C14.0129 15.419 14.25 14.8467 14.25 14.25V6H15C15.1989 6 15.3897 5.92098 15.5303 5.78033C15.671 5.63968 15.75 5.44891 15.75 5.25C15.75 5.05109 15.671 4.86032 15.5303 4.71967C15.3897 4.57902 15.1989 4.5 15 4.5ZM7.5 3.75C7.5 3.55109 7.57902 3.36032 7.71967 3.21967C7.86032 3.07902 8.05109 3 8.25 3H9.75C9.94891 3 10.1397 3.07902 10.2803 3.21967C10.421 3.36032 10.5 3.55109 10.5 3.75V4.5H7.5V3.75ZM12.75 14.25C12.75 14.4489 12.671 14.6397 12.5303 14.7803C12.3897 14.921 12.1989 15 12 15H6C5.80109 15 5.61032 14.921 5.46967 14.7803C5.32902 14.6397 5.25 14.4489 5.25 14.25V6H12.75V14.25ZM10.5 13.5C10.6989 13.5 10.8897 13.421 11.0303 13.2803C11.171 13.1397 11.25 12.9489 11.25 12.75V8.25C11.25 8.05109 11.171 7.86032 11.0303 7.71967C10.8897 7.57902 10.6989 7.5 10.5 7.5C10.3011 7.5 10.1103 7.57902 9.96967 7.71967C9.82902 7.86032 9.75 8.05109 9.75 8.25V12.75C9.75 12.9489 9.82902 13.1397 9.96967 13.2803C10.1103 13.421 10.3011 13.5 10.5 13.5Z"
          fill="#9E9EA4"
        />
      </svg>
    </button>
  </div>
</template>

<script setup>
//import { PTOptions } from "primevue/ts-helpers";
import { onMounted, ref, toRefs, watch } from "vue";

const props = defineProps({
  active: Boolean,
  title: String,
});

const { title } = toRefs(props);
const titleInput = ref("");

const emits = defineEmits(
  ["update:title", "tab:click", "delete:entrance"]
);

const isEditTitle = ref(false);
const isDelete = ref(false);

const styleInput = ref({
  root: ({ context }) => {
    return {
      class: [
        "!border-0 !border-b !rounded-none !p-0 !h-auto !w-max !text-black !opacity-100 !font-bold",
        context.disabled ? "!bg-transparent !border-b-0" : "",
      ],
    };
  },
});

watch(isEditTitle, (newV) => {
  if (!newV) {
    emits("update:title", titleInput.value);
  }
});

onMounted(() => {
  titleInput.value = props.title;
});
</script>

<style lang="scss" scoped>
  .tabItem {
    &__title {
      text-wrap: nowrap;
    }
  }
</style>
